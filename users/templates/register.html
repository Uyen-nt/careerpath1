{% load static %}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Đăng ký - CareerPath</title>
    <!-- Nhúng Font Awesome và Google Fonts (nếu cần) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"/>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap&subset=vietnamese" rel="stylesheet">
    <!-- ** DÙNG CHUNG FILE CSS VỚI TRANG ĐĂNG NHẬP ** -->
    <link rel="stylesheet" href="{% static 'css/user.css' %}">
</head>
<body class="page-register">
    <main class="login-wrapper">
        <div class="login-container">
            <!-- Cột Trái: Illustration -->
            <div class="login-illustration-panel">
                <div class="illustration-content">
                    {# **ĐẢM BẢO CẤU TRÚC GIỐNG HỆT TRANG ĐĂNG NHẬP** #}
                    
                    <h2 class="illustration-title">Bắt đầu hành trình với 
                        <span class="brand-text">CAREERPATH</span>
                    </h2>
                    <img src="{% static 'images/register.png' %}" 
                        alt="Minh họa Đăng ký" 
                        class="illustration-img"/>
                        
                    <p class="illustration-subtitle">
                        Định hướng nghề nghiệp và phát triển kỹ năng để tự tin bước vào tương lai.
                    </p>
                </div>
            </div>

            <!-- Cột Phải: Form Đăng Ký (Cập nhật) -->
            <div class="login-form-panel">
                <h1 class="form-title">Tạo tài khoản</h1>
                <form method="post" novalidate>
                    {% csrf_token %}
                    {% if form.non_field_errors %}
                        <div class="form-errors">{{ form.non_field_errors }}</div>
                    {% endif %}

                    <!-- Hàng Họ và Tên -->
                    <div class="form-row">
                        <div class="input-group-v2 {% if form.last_name.errors %}has-error{% endif %}">
                            <label for="{{ form.last_name.id_for_label }}"><i class="fas fa-user"></i> {{ form.last_name.label }}</label>
                            {{ form.last_name }}
                        </div>
                        <div class="input-group-v2 {% if form.first_name.errors %}has-error{% endif %}">
                            <label for="{{ form.first_name.id_for_label }}"><i class="fas fa-user"></i> {{ form.first_name.label }}</label>
                            {{ form.first_name }}
                        </div>
                    </div>
                    <div class="form-row-errors">
                        <small class="error-text">{{ form.last_name.errors.as_text|striptags }}</small>
                        <small class="error-text">{{ form.first_name.errors.as_text|striptags }}</small>
                    </div>

                    <!-- Tên đăng nhập -->
                    <div class="input-group-v2 {% if form.username.errors %}has-error{% endif %}">
                        <label for="{{ form.username.id_for_label }}"><i class="fas fa-user-circle"></i> {{ form.username.label }}</label>
                        {{ form.username }}
                        <small class="error-text">{{ form.username.errors.as_text|striptags }}</small>
                    </div>

                    <!-- Email -->
                    <div class="input-group-v2 {% if form.email.errors %}has-error{% endif %}">
                        <label for="{{ form.email.id_for_label }}"><i class="fas fa-envelope"></i> {{ form.email.label }}</label>
                        {{ form.email }}
                        <small class="error-text">{{ form.email.errors.as_text|striptags }}</small>
                    </div>
                    
                    <!-- Mật khẩu -->
                    <div class="input-group-v2 password-group {% if form.password.errors %}has-error{% endif %}">
                        <label for="{{ form.password.id_for_label }}"><i class="fas fa-lock"></i> {{ form.password1.label }}</label>
                        <div class="input-wrapper">
                            {{ form.password1 }}
                            <button type="button" class="toggle-password" aria-label="Hiện/Ẩn mật khẩu">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        {% if form.password1.errors %}
                            <small class="error-text">{{ form.password1.errors.as_text | striptags }}</small>
                        {% endif %}
                    </div>

                    <!-- Xác nhận Mật khẩu -->
                    <div class="input-group-v2 password-group {% if form.password2.errors %}has-error{% endif %}">
                        <label for="{{ form.password2.id_for_label }}"><i class="fas fa-lock"></i> {{ form.password2.label }}</label>
                        <div class="input-wrapper">
                            {{ form.password2 }}
                            <button type="button" class="toggle-password" aria-label="Hiện/Ẩn mật khẩu">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        {% if form.password2.errors %}
                            <small class="error-text">{{ form.password2.errors.as_text | striptags }}</small>
                        {% endif %}
                    </div>

                    <button type="submit" class="btn-submit">Đăng ký</button>
                </form>

                <!-- HIỂN THỊ LẠI CÁC PHẦN TỬ CUỐI -->
                <div class="or-divider"><span>Hoặc</span></div>
                <a href="{% url 'social:begin' 'google-oauth2' %}?next=/" class="google-btn">
                    <img src="https://www.svgrepo.com/show/475656/google-color.svg" alt="Google" width="22" height="22"/>
                    <span>Đăng ký với Google</span>
                </a>
                <p class="switch-form-text">Đã có tài khoản? <a href="{% url 'users:login' %}" class="switch-form-link">Đăng nhập ngay</a></p>
            </div>
        </div>
    </main>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                if (document.activeElement.tagName === "INPUT") {
                    document.activeElement.blur();
                }
            }, 50);
            document.querySelectorAll('.toggle-password').forEach(button => {
                button.addEventListener('click', function () {
                    const passwordInput = this.parentElement.querySelector('input[type="password"], input[type="text"]');
                    const icon = this.querySelector('i');

                    if (!passwordInput || !icon) return;

                    const isPassword = passwordInput.type === 'password';
                    passwordInput.type = isPassword ? 'text' : 'password';
                    icon.classList.toggle('fa-eye', !isPassword);
                    icon.classList.toggle('fa-eye-slash', isPassword);
                });
            });
        });
    </script>
</body>
</html>